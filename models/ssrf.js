var needle = require('needle');
function Ssrf()
{
    // 
}

Ssrf.prototype.show = function (req, res) {
    res.render('ssrf/show');
}

Ssrf.prototype.attack = function (req, res) {
    needle.get(req.query.url, { timeout: 3000 }, function(error, response) {
        if (!error && response.statusCode == 200) {
          res.render('ssrf/attack',{
                payload: "Request Successful",
            });
        } else {
          console.log('error')
          console.log(error)
          res.render('ssrf/attack',{
            payload: "Request Failed",
          });
        }
      });
}

module.exports = new Ssrf();