
require('dotenv').config();
if (process.env.SDK_ACTIVE == 'yes') {
    const shieldfy= require('shieldfy-nodejs-client');
    
    let shieldfy_start = {
        appKey: process.env.SHIELDFY_APP_KEY,
        appSecret: process.env.SHIELDFY_APP_SECRET,
        action: process.env.ACTION
    };
    
    if (process.env.SHIELDFY_APP_TEST == 'develop') {
        shieldfy_start = {
            appKey: process.env.SHIELDFY_APP_KEY,
            appSecret: process.env.SHIELDFY_APP_SECRET,
            endPoint: 'https://api-dev.shieldfy.co/v2/',
            action: process.env.ACTION
        };
    }
    
    shieldfy.start(shieldfy_start);
}

const express = require('express')

const app = express()
require('./users')

app.use((req, res, next) => {
    res.setHeader('X-XSS-Protection', 0);
    next();
});

const port = 3000

const Home = require('./models/home');
const Xss = require('./models/xss');
const Sqli = require('./models/sqli');
const Nosqli = require('./models/nosqli');
const Lfi = require('./models/lfi');
const Rce = require('./models/rce');
const _Buffer = require('./models/buffer');
const Ssrf = require('./models/ssrf');

// set the view engine to ejs
app.set('view engine', 'ejs');

app.get('/', Home);
// XSS
app.get('/xss', Xss.show);
app.get('/xss/attack', Xss.attack);
// SQLI
app.get('/sqli', Sqli.show);
app.get('/sqli/attack', Sqli.attack);
// NOSQLI
app.get('/nosqli', Nosqli.show);
app.get('/nosqli/attack', Nosqli.attack);
// Lfi
app.get('/lfi', Lfi.show);
app.get('/lfi/attack', Lfi.attack);
// RCE
app.get('/rce', Rce.show);
app.get('/rce/attack', Rce.attack);
// BUFFER
app.get('/buffer', _Buffer.show);
app.get('/buffer/attack', _Buffer.attack);
// SSRF
app.get('/ssrf', Ssrf.show);
app.get('/ssrf/attack', Ssrf.attack);

app.listen(port, () => console.log(`Example app listening on port ${port}!`));